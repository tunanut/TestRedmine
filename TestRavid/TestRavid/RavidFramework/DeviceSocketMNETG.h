#pragma once

#include "DeviceBase.h"

#define	MNETG_DEVTYPE_X		(1)
#define	MNETG_DEVTYPE_LX(x)	(DevX*1000+(x))
#define	MNETG_DEVTYPE_Y		(2)
#define	MNETG_DEVTYPE_LY(x)	(DevY*1000+(x))
#define	MNETG_DEVTYPE_L		(3)
#define	MNETG_DEVTYPE_M		(4)
#define	MNETG_DEVTYPE_SM		(5)
#define	MNETG_DEVTYPE_F		(6)
#define	MNETG_DEVTYPE_TT		(7)
#define	MNETG_DEVTYPE_TC		(8)
#define	MNETG_DEVTYPE_CT		(9)
#define	MNETG_DEVTYPE_CC		(10)
#define	MNETG_DEVTYPE_TN		(11)
#define	MNETG_DEVTYPE_CN		(12)
#define	MNETG_DEVTYPE_D		(13)
#define	MNETG_DEVTYPE_SD		(14)
#define	MNETG_DEVTYPE_TM		(15)
#define	MNETG_DEVTYPE_TS		(16)
#define	MNETG_DEVTYPE_TS2		(16002)
#define	MNETG_DEVTYPE_TS3		(16003)
#define	MNETG_DEVTYPE_CM		(17)
#define	MNETG_DEVTYPE_CS		(18)
#define	MNETG_DEVTYPE_CS2		(18002)
#define	MNETG_DEVTYPE_CS3		(18003)
#define	MNETG_DEVTYPE_A		(19)
#define	MNETG_DEVTYPE_Z		(20)
#define	MNETG_DEVTYPE_V		(21)
#define	MNETG_DEVTYPE_R		(22)
#define	MNETG_DEVTYPE_ZR		(220)
#define	MNETG_DEVTYPE_B		(23)
#define	MNETG_DEVTYPE_LB(x)	(DevB*1000+(x))
#define	MNETG_DEVTYPE_W		(24)
#define	MNETG_DEVTYPE_LW(x)	(DevW*1000+(x))
#define	MNETG_DEVTYPE_QSB		(25)
#define	MNETG_DEVTYPE_LSB(x)	(DevQSB*1000+(x))
#define	MNETG_DEVTYPE_STT		(26)
#define	MNETG_DEVTYPE_STC		(27)
#define	MNETG_DEVTYPE_QSW		(28)
#define	MNETG_DEVTYPE_LSW(x)	(DevQSW*1000+(x))
#define	MNETG_DEVTYPE_SPG(x)	(29*1000+(x))
#define	MNETG_DEVTYPE_QV		(30)
#define	MNETG_DEVTYPE_MRB		(33)
#define	MNETG_DEVTYPE_MAB		(34)
#define	MNETG_DEVTYPE_STN		(35)
#define	MNETG_DEVTYPE_Ww		(36)
#define	MNETG_DEVTYPE_Wr		(37)
#define	MNETG_DEVTYPE_LZ		(38)
#define	MNETG_DEVTYPE_RD		(39)
#define MNETG_DEVTYPE_FS		(40)
#define	MNETG_DEVTYPE_LTT		(41)
#define	MNETG_DEVTYPE_LTC		(42)
#define	MNETG_DEVTYPE_LTN		(43)
#define	MNETG_DEVTYPE_LCT		(44)
#define	MNETG_DEVTYPE_LCC		(45)
#define	MNETG_DEVTYPE_LCN		(46)
#define	MNETG_DEVTYPE_LSTT		(47)
#define	MNETG_DEVTYPE_LSTC		(48)
#define	MNETG_DEVTYPE_LSTN		(49)
#define	MNETG_DEVTYPE_SPB		(50)
#define	MNETG_DEVTYPE_SPB1		(501)
#define	MNETG_DEVTYPE_SPB2		(502)
#define	MNETG_DEVTYPE_SPB3		(503)
#define	MNETG_DEVTYPE_SPB4		(504)
#define	MNETG_DEVTYPE_SPX		(51)
#define	MNETG_DEVTYPE_SPY		(52)
#define	MNETG_DEVTYPE_USER		(100)
#define	MNETG_DEVTYPE_MAIL		(101)
#define	MNETG_DEVTYPE_MAILNC	(102)
#define	MNETG_DEVTYPE_ER0		(22000)
#define	MNETG_DEVTYPE_ER1		(22001)
#define	MNETG_DEVTYPE_ER2		(22002)
#define	MNETG_DEVTYPE_ER3		(22003)
#define	MNETG_DEVTYPE_ER4		(22004)
#define	MNETG_DEVTYPE_ER5		(22005)
#define	MNETG_DEVTYPE_ER6		(22006)
#define	MNETG_DEVTYPE_ER7		(22007)
#define	MNETG_DEVTYPE_ER8		(22008)
#define	MNETG_DEVTYPE_ER9		(22009)
#define	MNETG_DEVTYPE_ER10		(22010)
#define	MNETG_DEVTYPE_ER11		(22011)
#define	MNETG_DEVTYPE_ER12		(22012)
#define	MNETG_DEVTYPE_ER13		(22013)
#define	MNETG_DEVTYPE_ER14		(22014)
#define	MNETG_DEVTYPE_ER15		(22015)
#define	MNETG_DEVTYPE_ER16		(22016)
#define	MNETG_DEVTYPE_ER17		(22017)
#define	MNETG_DEVTYPE_ER18		(22018)
#define	MNETG_DEVTYPE_ER19		(22019)
#define	MNETG_DEVTYPE_ER20		(22020)
#define	MNETG_DEVTYPE_ER21		(22021)
#define	MNETG_DEVTYPE_ER22		(22022)
#define	MNETG_DEVTYPE_ER23		(22023)
#define	MNETG_DEVTYPE_ER24		(22024)
#define	MNETG_DEVTYPE_ER25		(22025)
#define	MNETG_DEVTYPE_ER26		(22026)
#define	MNETG_DEVTYPE_ER27		(22027)
#define	MNETG_DEVTYPE_ER28		(22028)
#define	MNETG_DEVTYPE_ER29		(22029)
#define	MNETG_DEVTYPE_ER30		(22030)
#define	MNETG_DEVTYPE_ER31		(22031)
#define	MNETG_DEVTYPE_ER32		(22032)
#define	MNETG_DEVTYPE_ER33		(22033)
#define	MNETG_DEVTYPE_ER34		(22034)
#define	MNETG_DEVTYPE_ER35		(22035)
#define	MNETG_DEVTYPE_ER36		(22036)
#define	MNETG_DEVTYPE_ER37		(22037)
#define	MNETG_DEVTYPE_ER38		(22038)
#define	MNETG_DEVTYPE_ER39		(22039)
#define	MNETG_DEVTYPE_ER40		(22040)
#define	MNETG_DEVTYPE_ER41		(22041)
#define	MNETG_DEVTYPE_ER42		(22042)
#define	MNETG_DEVTYPE_ER43		(22043)
#define	MNETG_DEVTYPE_ER44		(22044)
#define	MNETG_DEVTYPE_ER45		(22045)
#define	MNETG_DEVTYPE_ER46		(22046)
#define	MNETG_DEVTYPE_ER47		(22047)
#define	MNETG_DEVTYPE_ER48		(22048)
#define	MNETG_DEVTYPE_ER49		(22049)
#define	MNETG_DEVTYPE_ER50		(22050)
#define	MNETG_DEVTYPE_ER51		(22051)
#define	MNETG_DEVTYPE_ER52		(22052)
#define	MNETG_DEVTYPE_ER53		(22053)
#define	MNETG_DEVTYPE_ER54		(22054)
#define	MNETG_DEVTYPE_ER55		(22055)
#define	MNETG_DEVTYPE_ER56		(22056)
#define	MNETG_DEVTYPE_ER57		(22057)
#define	MNETG_DEVTYPE_ER58		(22058)
#define	MNETG_DEVTYPE_ER59		(22059)
#define	MNETG_DEVTYPE_ER60		(22060)
#define	MNETG_DEVTYPE_ER61		(22061)
#define	MNETG_DEVTYPE_ER62		(22062)
#define	MNETG_DEVTYPE_ER63		(22063)
#define	MNETG_DEVTYPE_ER64		(22064)
#define	MNETG_DEVTYPE_ER65		(22065)
#define	MNETG_DEVTYPE_ER66		(22066)
#define	MNETG_DEVTYPE_ER67		(22067)
#define	MNETG_DEVTYPE_ER68		(22068)
#define	MNETG_DEVTYPE_ER69		(22069)
#define	MNETG_DEVTYPE_ER70		(22070)
#define	MNETG_DEVTYPE_ER71		(22071)
#define	MNETG_DEVTYPE_ER72		(22072)
#define	MNETG_DEVTYPE_ER73		(22073)
#define	MNETG_DEVTYPE_ER74		(22074)
#define	MNETG_DEVTYPE_ER75		(22075)
#define	MNETG_DEVTYPE_ER76		(22076)
#define	MNETG_DEVTYPE_ER77		(22077)
#define	MNETG_DEVTYPE_ER78		(22078)
#define	MNETG_DEVTYPE_ER79		(22079)
#define	MNETG_DEVTYPE_ER80		(22080)
#define	MNETG_DEVTYPE_ER81		(22081)
#define	MNETG_DEVTYPE_ER82		(22082)
#define	MNETG_DEVTYPE_ER83		(22083)
#define	MNETG_DEVTYPE_ER84		(22084)
#define	MNETG_DEVTYPE_ER85		(22085)
#define	MNETG_DEVTYPE_ER86		(22086)
#define	MNETG_DEVTYPE_ER87		(22087)
#define	MNETG_DEVTYPE_ER88		(22088)
#define	MNETG_DEVTYPE_ER89		(22089)
#define	MNETG_DEVTYPE_ER90		(22090)
#define	MNETG_DEVTYPE_ER91		(22091)
#define	MNETG_DEVTYPE_ER92		(22092)
#define	MNETG_DEVTYPE_ER93		(22093)
#define	MNETG_DEVTYPE_ER94		(22094)
#define	MNETG_DEVTYPE_ER95		(22095)
#define	MNETG_DEVTYPE_ER96		(22096)
#define	MNETG_DEVTYPE_ER97		(22097)
#define	MNETG_DEVTYPE_ER98		(22098)
#define	MNETG_DEVTYPE_ER99		(22099)
#define	MNETG_DEVTYPE_ER100	(22100)
#define	MNETG_DEVTYPE_ER101	(22101)
#define	MNETG_DEVTYPE_ER102	(22102)
#define	MNETG_DEVTYPE_ER103	(22103)
#define	MNETG_DEVTYPE_ER104	(22104)
#define	MNETG_DEVTYPE_ER105	(22105)
#define	MNETG_DEVTYPE_ER106	(22106)
#define	MNETG_DEVTYPE_ER107	(22107)
#define	MNETG_DEVTYPE_ER108	(22108)
#define	MNETG_DEVTYPE_ER109	(22109)
#define	MNETG_DEVTYPE_ER110	(22110)
#define	MNETG_DEVTYPE_ER111	(22111)
#define	MNETG_DEVTYPE_ER112	(22112)
#define	MNETG_DEVTYPE_ER113	(22113)
#define	MNETG_DEVTYPE_ER114	(22114)
#define	MNETG_DEVTYPE_ER115	(22115)
#define	MNETG_DEVTYPE_ER116	(22116)
#define	MNETG_DEVTYPE_ER117	(22117)
#define	MNETG_DEVTYPE_ER118	(22118)
#define	MNETG_DEVTYPE_ER119	(22119)
#define	MNETG_DEVTYPE_ER120	(22120)
#define	MNETG_DEVTYPE_ER121	(22121)
#define	MNETG_DEVTYPE_ER122	(22122)
#define	MNETG_DEVTYPE_ER123	(22123)
#define	MNETG_DEVTYPE_ER124	(22124)
#define	MNETG_DEVTYPE_ER125	(22125)
#define	MNETG_DEVTYPE_ER126	(22126)
#define	MNETG_DEVTYPE_ER127	(22127)
#define	MNETG_DEVTYPE_ER128	(22128)
#define	MNETG_DEVTYPE_ER129	(22129)
#define	MNETG_DEVTYPE_ER130	(22130)
#define	MNETG_DEVTYPE_ER131	(22131)
#define	MNETG_DEVTYPE_ER132	(22132)
#define	MNETG_DEVTYPE_ER133	(22133)
#define	MNETG_DEVTYPE_ER134	(22134)
#define	MNETG_DEVTYPE_ER135	(22135)
#define	MNETG_DEVTYPE_ER136	(22136)
#define	MNETG_DEVTYPE_ER137	(22137)
#define	MNETG_DEVTYPE_ER138	(22138)
#define	MNETG_DEVTYPE_ER139	(22139)
#define	MNETG_DEVTYPE_ER140	(22140)
#define	MNETG_DEVTYPE_ER141	(22141)
#define	MNETG_DEVTYPE_ER142	(22142)
#define	MNETG_DEVTYPE_ER143	(22143)
#define	MNETG_DEVTYPE_ER144	(22144)
#define	MNETG_DEVTYPE_ER145	(22145)
#define	MNETG_DEVTYPE_ER146	(22146)
#define	MNETG_DEVTYPE_ER147	(22147)
#define	MNETG_DEVTYPE_ER148	(22148)
#define	MNETG_DEVTYPE_ER149	(22149)
#define	MNETG_DEVTYPE_ER150	(22150)
#define	MNETG_DEVTYPE_ER151	(22151)
#define	MNETG_DEVTYPE_ER152	(22152)
#define	MNETG_DEVTYPE_ER153	(22153)
#define	MNETG_DEVTYPE_ER154	(22154)
#define	MNETG_DEVTYPE_ER155	(22155)
#define	MNETG_DEVTYPE_ER156	(22156)
#define	MNETG_DEVTYPE_ER157	(22157)
#define	MNETG_DEVTYPE_ER158	(22158)
#define	MNETG_DEVTYPE_ER159	(22159)
#define	MNETG_DEVTYPE_ER160	(22160)
#define	MNETG_DEVTYPE_ER161	(22161)
#define	MNETG_DEVTYPE_ER162	(22162)
#define	MNETG_DEVTYPE_ER163	(22163)
#define	MNETG_DEVTYPE_ER164	(22164)
#define	MNETG_DEVTYPE_ER165	(22165)
#define	MNETG_DEVTYPE_ER166	(22166)
#define	MNETG_DEVTYPE_ER167	(22167)
#define	MNETG_DEVTYPE_ER168	(22168)
#define	MNETG_DEVTYPE_ER169	(22169)
#define	MNETG_DEVTYPE_ER170	(22170)
#define	MNETG_DEVTYPE_ER171	(22171)
#define	MNETG_DEVTYPE_ER172	(22172)
#define	MNETG_DEVTYPE_ER173	(22173)
#define	MNETG_DEVTYPE_ER174	(22174)
#define	MNETG_DEVTYPE_ER175	(22175)
#define	MNETG_DEVTYPE_ER176	(22176)
#define	MNETG_DEVTYPE_ER177	(22177)
#define	MNETG_DEVTYPE_ER178	(22178)
#define	MNETG_DEVTYPE_ER179	(22179)
#define	MNETG_DEVTYPE_ER180	(22180)
#define	MNETG_DEVTYPE_ER181	(22181)
#define	MNETG_DEVTYPE_ER182	(22182)
#define	MNETG_DEVTYPE_ER183	(22183)
#define	MNETG_DEVTYPE_ER184	(22184)
#define	MNETG_DEVTYPE_ER185	(22185)
#define	MNETG_DEVTYPE_ER186	(22186)
#define	MNETG_DEVTYPE_ER187	(22187)
#define	MNETG_DEVTYPE_ER188	(22188)
#define	MNETG_DEVTYPE_ER189	(22189)
#define	MNETG_DEVTYPE_ER190	(22190)
#define	MNETG_DEVTYPE_ER191	(22191)
#define	MNETG_DEVTYPE_ER192	(22192)
#define	MNETG_DEVTYPE_ER193	(22193)
#define	MNETG_DEVTYPE_ER194	(22194)
#define	MNETG_DEVTYPE_ER195	(22195)
#define	MNETG_DEVTYPE_ER196	(22196)
#define	MNETG_DEVTYPE_ER197	(22197)
#define	MNETG_DEVTYPE_ER198	(22198)
#define	MNETG_DEVTYPE_ER199	(22199)
#define	MNETG_DEVTYPE_ER200	(22200)
#define	MNETG_DEVTYPE_ER201	(22201)
#define	MNETG_DEVTYPE_ER202	(22202)
#define	MNETG_DEVTYPE_ER203	(22203)
#define	MNETG_DEVTYPE_ER204	(22204)
#define	MNETG_DEVTYPE_ER205	(22205)
#define	MNETG_DEVTYPE_ER206	(22206)
#define	MNETG_DEVTYPE_ER207	(22207)
#define	MNETG_DEVTYPE_ER208	(22208)
#define	MNETG_DEVTYPE_ER209	(22209)
#define	MNETG_DEVTYPE_ER210	(22210)
#define	MNETG_DEVTYPE_ER211	(22211)
#define	MNETG_DEVTYPE_ER212	(22212)
#define	MNETG_DEVTYPE_ER213	(22213)
#define	MNETG_DEVTYPE_ER214	(22214)
#define	MNETG_DEVTYPE_ER215	(22215)
#define	MNETG_DEVTYPE_ER216	(22216)
#define	MNETG_DEVTYPE_ER217	(22217)
#define	MNETG_DEVTYPE_ER218	(22218)
#define	MNETG_DEVTYPE_ER219	(22219)
#define	MNETG_DEVTYPE_ER220	(22220)
#define	MNETG_DEVTYPE_ER221	(22221)
#define	MNETG_DEVTYPE_ER222	(22222)
#define	MNETG_DEVTYPE_ER223	(22223)
#define	MNETG_DEVTYPE_ER224	(22224)
#define	MNETG_DEVTYPE_ER225	(22225)
#define	MNETG_DEVTYPE_ER226	(22226)
#define	MNETG_DEVTYPE_ER227	(22227)
#define	MNETG_DEVTYPE_ER228	(22228)
#define	MNETG_DEVTYPE_ER229	(22229)
#define	MNETG_DEVTYPE_ER230	(22230)
#define	MNETG_DEVTYPE_ER231	(22231)
#define	MNETG_DEVTYPE_ER232	(22232)
#define	MNETG_DEVTYPE_ER233	(22233)
#define	MNETG_DEVTYPE_ER234	(22234)
#define	MNETG_DEVTYPE_ER235	(22235)
#define	MNETG_DEVTYPE_ER236	(22236)
#define	MNETG_DEVTYPE_ER237	(22237)
#define	MNETG_DEVTYPE_ER238	(22238)
#define	MNETG_DEVTYPE_ER239	(22239)
#define	MNETG_DEVTYPE_ER240	(22240)
#define	MNETG_DEVTYPE_ER241	(22241)
#define	MNETG_DEVTYPE_ER242	(22242)
#define	MNETG_DEVTYPE_ER243	(22243)
#define	MNETG_DEVTYPE_ER244	(22244)
#define	MNETG_DEVTYPE_ER245	(22245)
#define	MNETG_DEVTYPE_ER246	(22246)
#define	MNETG_DEVTYPE_ER247	(22247)
#define	MNETG_DEVTYPE_ER248	(22248)
#define	MNETG_DEVTYPE_ER249	(22249)
#define	MNETG_DEVTYPE_ER250	(22250)
#define	MNETG_DEVTYPE_ER251	(22251)
#define	MNETG_DEVTYPE_ER252	(22252)
#define	MNETG_DEVTYPE_ER253	(22253)
#define	MNETG_DEVTYPE_ER254	(22254)
#define	MNETG_DEVTYPE_ER255	(22255)
#define	MNETG_DEVTYPE_ER256	(22256)
#define	MNETG_DEVTYPE_RBM		(-32768)
#define	MNETG_DEVTYPE_RAB		(-32736)
#define	MNETG_DEVTYPE_RX		(-32735)
#define	MNETG_DEVTYPE_RY		(-32734)
#define	MNETG_DEVTYPE_RW		(-32732)
#define	MNETG_DEVTYPE_ARB		(-32704)
#define	MNETG_DEVTYPE_SB		(-32669)
#define	MNETG_DEVTYPE_SW		(-32668)
#define	MNETG_DEVTYPE_EM(x)	(31*1000+(x))
#define	MNETG_DEVTYPE_ED(x)	(32*1000+(x))

namespace Ravid
{
	namespace Device
	{
		class AFX_EXT_CLASS CDeviceSocketMNETG : public CDeviceBase
		{
		public:
			RavidUseDynamicCreation();

			RavidPreventCopySelf(CDeviceSocketMNETG);

			DECLARE_DYNAMIC(CDeviceSocketMNETG)
			
			CDeviceSocketMNETG();
			virtual ~CDeviceSocketMNETG();

			virtual EDeviceInitializeResult Initialize() override;
			virtual EDeviceTerminateResult Terminate() override;

			virtual bool LoadSettings() override;

			virtual BOOL OnInitDialog();

			afx_msg void OnDestroy();
			afx_msg void OnTimer(_In_ UINT_PTR nIDEvent);

			virtual bool OnParameterChanged(_In_ int nParam, _In_ CString strValue) override;

			bool SendData(_In_ LPCTSTR lpszAddr, _In_ short sDevType, _In_ long nLength, _In_ short * lpsData);
			bool SendData(_In_ LPCTSTR lpszAddr, _In_ short sDevType, _In_ long nLength, _In_ long * lplData);
			bool SendData(_In_ short sDevType, _In_ short sDevNo, _In_ long nLegnth, _In_ short* lpsData);
			bool SendData(_In_ short sDevType, _In_ short sDevNo, _In_ long nLegnth, _In_ long* lplData);
			bool SendData(_In_ long nDevType, _In_ long nDevNo, _In_ long nLegnth, _In_ short* lpsData);

			bool RecvData(_In_ LPCTSTR lpszAddr, _In_ short sDevType, _In_ long nLength, _Out_ short * lpsData);
			bool RecvData(_In_ LPCTSTR lpszAddr, _In_ short sDevType, _In_ long nLength, _Out_ long * lplData);
			bool RecvData(_In_ short sDevType, _In_ short sDevNo, _In_ long nLegnth, _Out_ short* lpsData);
			bool RecvData(_In_ short sDevType, _In_ short sDevNo, _In_ long nLegnth, _Out_ long* lplData);
			bool RecvData(_In_ long nDevType, _In_ long nDevNo, _In_ long nLegnth, _Out_ short* lpsData);

			bool SetChannel(int nChannel);
			int GetChannel();

			bool SetStationNo(int nStationNo);
			int GetStationNo();

			bool SetNetworkNo(int nNetworkNo);
			int GetNetworkNo();

			long GetDeviceTypeNumber(_In_ LPCTSTR lpszAddr);

		public:
			DECLARE_MESSAGE_MAP()

		protected:
			virtual bool DoesModuleExist();

		protected:

			long m_nChannel = 0;
			long m_nStationNo = 0;
			long m_nNetworkNo = 0;

			long m_nPath = 0;
		};
	}
}

